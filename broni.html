<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Бронирование компьютера</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        /* Легенда по статусам */
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0 25px;
            font-size: 14px;
            user-select: none;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        .legend-available {
            background-color: #d3d3d3;
            border: 1px solid #bbb;
        }
        .legend-booked {
            background-color: #dc3545;
        }
        .legend-selected {
            background-color: #007bff;
        }

        label {
            font-weight: bold;
            margin: 10px 0 5px;
            display: block;
        }
        input, button {
            padding: 10px;
            font-size: 16px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 100%;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .time-slots {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }
        .time-slot {
            width: 48%;
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            user-select: none;
        }
        .time-slot.available {
            background-color: #d3d3d3;
            color: #333;
        }
        .time-slot.booked {
            background-color: #dc3545;
            color: white;
            cursor: not-allowed;
        }
        .time-slot.selected {
            background-color: #007bff;
            color: white;
        }
        .total {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-top: 20px;
        }
        /* Сообщения */
        #message-box {
            display: none;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
            user-select: none;
        }
        #message-box.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        #message-box.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        #message-box.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Бронирование компьютера</h1>

        <!-- Легенда по цветам статусов -->
        <div class="legend" aria-label="Легенда цветов статуса времени">
            <div class="legend-item">
                <div class="legend-color legend-available"></div> Свободно
            </div>
            <div class="legend-item">
                <div class="legend-color legend-booked"></div> Занято
            </div>
            <div class="legend-item">
                <div class="legend-color legend-selected"></div> Выбрано
            </div>
        </div>

        <label for="booking-date">Выберите дату:</label>
        <input type="date" id="booking-date" required />

        <div id="time-slots-container" style="display: none;">
            <label>Доступное время:</label>
            <div class="time-slots" id="time-slots"></div>
        </div>

        <div id="message-box"></div> <!-- Блок для сообщений -->

        <div class="total" id="total-price">Общая стоимость: 0 руб.</div>
        <button id="confirm-button" style="display: none;" onclick="confirmBooking()">Забронировать</button>
    </div>

    <script>
        const pricePerHour = 150; // Фиксированная цена за час
        const bookedSlots = ["10:00-11:00", "14:00-15:00"]; // Уже забронированные интервалы (пример)
        const timeSlotsContainer = document.getElementById("time-slots-container");
        const timeSlotsDiv = document.getElementById("time-slots");
        const totalPriceDiv = document.getElementById("total-price");
        const confirmButton = document.getElementById("confirm-button");
        const messageBox = document.getElementById("message-box");

        let selectedSlots = [];

        document.getElementById("booking-date").addEventListener("change", () => {
            const selectedDate = new Date(document.getElementById("booking-date").value);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (selectedDate < today) {
                showMessage("Нельзя выбрать прошедшую дату.", "error");
                timeSlotsContainer.style.display = "none";
                clearSelection();
                return;
            }

            generateTimeSlots();
        });

        function generateTimeSlots() {
            timeSlotsDiv.innerHTML = "";
            selectedSlots = [];
            updateTotalPrice();
            clearMessage();

            const times = generateTimeRanges();

            times.forEach(time => {
                const slot = document.createElement("div");
                slot.textContent = time;
                slot.classList.add("time-slot");

                if (bookedSlots.includes(time)) {
                    slot.classList.add("booked");
                } else {
                    slot.classList.add("available");
                    slot.addEventListener("click", () => toggleSlotSelection(slot, time));
                }

                timeSlotsDiv.appendChild(slot);
            });

            timeSlotsContainer.style.display = "block";
        }

        function generateTimeRanges() {
            const ranges = [];
            for (let i = 0; i < 24; i++) {
                const start = i.toString().padStart(2, "0") + ":00";
                const end = (i + 1).toString().padStart(2, "0") + ":00";
                ranges.push(`${start}-${end}`);
            }
            return ranges;
        }

        function toggleSlotSelection(slot, time) {
            clearMessage();
            if (slot.classList.contains("selected")) {
                slot.classList.remove("selected");
                selectedSlots = selectedSlots.filter(t => t !== time);
            } else {
                if (selectedSlots.length >= 8) {
                    showMessage("Нельзя выбрать больше 8 часов.", "error");
                    return;
                }
                slot.classList.add("selected");
                selectedSlots.push(time);
            }
            updateTotalPrice();
        }

        function updateTotalPrice() {
            const total = selectedSlots.length * pricePerHour;
            totalPriceDiv.textContent = `Общая стоимость: ${total} руб.`;
            confirmButton.style.display = selectedSlots.length > 0 ? "inline-block" : "none";
        }

        function confirmBooking() {
            if (selectedSlots.length === 0) {
                showMessage("Выберите хотя бы один временной интервал.", "error");
                return;
            }

            showMessage(
                `Вы забронировали следующие интервалы: ${selectedSlots.join(", ")}. Общая стоимость: ${selectedSlots.length * pricePerHour} руб.`,
                "success",
                5000
            );

            selectedSlots.forEach(time => {
                const slot = [...timeSlotsDiv.children].find(slot => slot.textContent === time);
                if (slot) {
                    slot.classList.remove("available", "selected");
                    slot.classList.add("booked");
                    slot.style.cursor = "not-allowed";
                }
                bookedSlots.push(time); // Добавляем в забронированные, чтобы не выбирать повторно
            });

            selectedSlots = [];
            updateTotalPrice();
        }

        function showMessage(text, type = "info", duration = 3000) {
            messageBox.textContent = text;
            messageBox.className = "";
            messageBox.classList.add(type);
            messageBox.style.display = "block";
            clearTimeout(messageBox.timeoutId);
            messageBox.timeoutId = setTimeout(() => {
                messageBox.style.display = "none";
            }, duration);
        }

        function clearMessage() {
            messageBox.style.display = "none";
            messageBox.textContent = "";
            messageBox.className = "";
            clearTimeout(messageBox.timeoutId);
        }

        function clearSelection() {
            selectedSlots = [];
            updateTotalPrice();
        }
    </script>
</body>
</html>
